--- a/net/minecraft/server/CustomFunctionData.java
+++ b/net/minecraft/server/CustomFunctionData.java
@@ -30,7 +30,7 @@
     }
 
     public com.mojang.brigadier.CommandDispatcher<CommandListenerWrapper> getCommandDispatcher() {
-        return this.server.getCommandDispatcher().a();
+        return this.server.vanillaCommandDispatcher.a(); // CraftBukkit
     }
 
     public void tick() {
